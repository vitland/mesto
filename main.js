(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===t(i)?i:String(i)),o)}var i}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl="https://mesto.nomoreparties.co/v1/cohort-63",this._token="bfea2fb3-1d49-4e0a-bbc4-333aa2efb088"}var n,r;return n=t,(r=[{key:"getUser",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"editUser",value:function(t){var e=t.name,n=t.about;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:n})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"editUserAvatar",value:function(t){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"getCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"addCard",value:function(t){var e=t.name,n=t.link;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:n})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"removeCard",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t),{method:"DELETE",headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){return console.log(t)})).catch((function(t){return console.log(t)}))}},{key:"addLike",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"PUT",headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"removeLike",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(),r=".elements__template",o=".element__image",i=".element__fav",u={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".popup__submit-button",activeButtonClass:"popup__submit-button_active",inputErrorClass:"form__input-error",errorClass:"form__input-error_visible",inputErrorBorder:"form__input_error"},a=document.querySelector(".profile__avatar-container"),c=document.querySelector(".profile__button-change"),s=document.querySelector(".form__input_type_name"),l=document.querySelector(".form__input_type_occupation"),f=document.querySelector(".profile__button-add"),p=document.querySelector(".popup__image"),y=document.querySelector(".popup__image-caption"),m=document.forms["profile-form"],b=document.forms["place-form"],h=document.forms["avatar-form"];function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==v(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===v(o)?o:String(o)),r)}var o}var _=function(){function t(e,n,r,u,a,c){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e.name,this._link=e.link,this._likes=e.likes,this._likeHandler=c,this._cardId=e._id,this._ownerId=e.owner._id,this._getCurrentUser=n,this._templateSelector=r,this._openImagePopup=u,this._openConfirmPopup=a,this.element=this._getTemplate(),this._image=this.element.querySelector(o),this._likeCounter=this.element.querySelector(".element__fav-counter"),this._imageCaption=this.element.querySelector(".element__text"),this._removeIcon=this.element.querySelector(".element__bin"),this._favButton=this.element.querySelector(i)}var e,n;return e=t,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}},{key:"_setEventListeners",value:function(){var t=this;this.element.querySelector(".element__bin").addEventListener("click",(function(){return t._openConfirmPopup(t._cardId,t.element)})),this.element.querySelector(i).addEventListener("click",(function(e){return t._likeHandler(e,t._cardId,t._likeCounter)})),this.element.querySelector(o).addEventListener("click",(function(e){t._openImagePopup({name:e.target.alt,link:e.target.src})}))}},{key:"generateCard",value:function(){var t=this;return this._getCurrentUser.then((function(e){e._id===t._ownerId&&t._removeIcon.classList.remove("disabled"),t._likes.find((function(t){return t._id===e._id}))&&t._favButton.classList.toggle("element__fav_active")})),this._setEventListeners(),this._image.src=this._link,this._image.alt=this._name,this._imageCaption.textContent=this._name,this._likeCounter.textContent=this._likes.length,this.element}}])&&d(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==g(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===g(o)?o:String(o)),r)}var o}var w=function(){function t(e,n){var r=e.items,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderItems",value:function(){var t=this;this._items.then((function(e){e.forEach((function(e){t._renderer(e)}))}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&S(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==k(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===k(o)?o:String(o)),r)}var o}var j=function(){function t(e){var n=e.nameSelector,r=e.jobSelector,o=e.avatarSelector;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=document.querySelector(n),this._about=document.querySelector(r),this._avatar=document.querySelector(o),this.user={}}var e,n;return e=t,(n=[{key:"setUserInfo",value:function(t){this._name.textContent=t.name,this._about.textContent=t.about,this._avatar.src=t.avatar,this._id=t._id}},{key:"getUserInfo",value:function(t){return this.user.name=t.name,this.user.about=t.about,this.user.avatar=t.avatar,this.user.id=t._id,this.user}},{key:"editUserInfo",value:function(t){var e=t.name,n=t.about;this._name.textContent=e,this._about.textContent=n}},{key:"editUserAvatar",value:function(t){var e=t.avatar;this._avatar.src=e}}])&&E(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,L(r.key),r)}}function L(t){var e=function(t,e){if("object"!==P(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===P(e)?e:String(e)}var C=function(){function t(e){var n,r,o,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=function(t){"Escape"===t.key&&(window.removeEventListener("keydown",i._handleEscClose),i._popup.classList.remove("popup_opened"))},(r=L(r="_handleEscClose"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this._popup=document.querySelector(e)}var e,n;return e=t,(n=[{key:"open",value:function(){window.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}},{key:"close",value:function(){window.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove("popup_opened")}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("mousedown",(function(e){(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close-icon"))&&t.close()})),window.addEventListener("keydown",this._handleEscClose)}}])&&O(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==T(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===T(o)?o:String(o)),r)}var o}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=R(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},q.apply(this,arguments)}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}function R(t){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},R(t)}var B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=R(r);if(o){var n=R(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===T(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,t)}return e=u,(n=[{key:"open",value:function(t){var e=t.name,n=t.link;q(R(u.prototype),"open",this).call(this),p.src=n,p.alt=e,y.textContent=e}}])&&I(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(C);function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==x(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===x(o)?o:String(o)),r)}var o}function D(){return D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=V(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},D.apply(this,arguments)}function z(t,e){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},z(t,e)}function V(t){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V(t)}var N=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&z(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=V(r);if(o){var n=V(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===x(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t))._handleSubmitForm=e,n._form=n._popup.querySelector(".form"),n._inputList=Array.from(n._form.querySelectorAll(".form__input")),n._submitButton=n._form.querySelector(u.submitButtonSelector),n}return e=a,(n=[{key:"_getInputValues",value:function(){return this._inputList.reduce((function(t,e){return t[e.name]=e.value,t}),{})}},{key:"renderLoading",value:function(t){t?(console.log(this._submitButton),this._submitButton.textContent="Сохранение..."):this._submitButton.textContent="Сохранить"}},{key:"setEventListeners",value:function(){var t=this;D(V(a.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(e){e.preventDefault(),t._handleSubmitForm(t._getInputValues())}))}},{key:"close",value:function(){D(V(a.prototype),"close",this).call(this),this._form.reset()}},{key:"open",value:function(){D(V(a.prototype),"open",this).call(this)}}])&&A(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(C);function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==H(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===H(o)?o:String(o)),r)}var o}function F(){return F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},F.apply(this,arguments)}function M(t,e){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},M(t,e)}function $(t){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$(t)}var G=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=$(r);if(o){var n=$(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===H(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._button=n._popup.querySelector(".form__submit-button"),n._handleSubmit=e,n}return e=u,(n=[{key:"_setEventListeners",value:function(){var t=this;F($(u.prototype),"setEventListeners",this).call(this),this._button.addEventListener("mousedown",(function(e){e.preventDefault(),t._handleSubmit(t._cardId,t._element)}))}},{key:"close",value:function(){F($(u.prototype),"close",this).call(this)}},{key:"open",value:function(t,e){F($(u.prototype),"open",this).call(this),this._cardId=t,this._element=e,this._setEventListeners()}}])&&J(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(C);function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==K(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===K(o)?o:String(o)),r)}var o}var X=function(){function t(e,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._options=e,this._formElement=n,this._inputList=function(t){if(Array.isArray(t))return Q(t)}(r=this._formElement.querySelectorAll(this._options.inputSelector))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return Q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),this._buttonElement=this._formElement.querySelector(this._options.submitButtonSelector)}var e,n;return e=t,(n=[{key:"_setEventListeners",value:function(){var t=this;this._formElement.addEventListener("submit",(function(t){return t.preventDefault()})),this._formElement.addEventListener("reset",(function(){setTimeout((function(){return t.setButtonState()}),0)})),this._formElement.querySelectorAll(this._options.inputSelector).forEach((function(e){return e.addEventListener("input",(function(){t._toggleInputError(e),t.setButtonState()}))}))}},{key:"setButtonState",value:function(){this._getInputStatus(this._inputList)?(this._buttonElement.setAttribute("disabled","disabled"),this._buttonElement.classList.remove(this._options.activeButtonClass)):(this._buttonElement.removeAttribute("disabled","disabled"),this._buttonElement.classList.add(this._options.activeButtonClass))}},{key:"_getInputStatus",value:function(t){return t.some((function(t){return!t.validity.valid}))}},{key:"_toggleInputError",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}},{key:"_showInputError",value:function(t){var e=this._formElement.querySelector(".".concat(t.name,"-input-error"));e.textContent=t.validationMessage,e.classList.add(this._options.errorClass),t.classList.add(this._options.inputErrorBorder)}},{key:"_hideInputError",value:function(t){this._formElement.querySelector(".".concat(t.name,"-input-error")).classList.remove(this._options.errorClass),t.classList.remove(this._options.inputErrorBorder)}},{key:"enableValidation",value:function(){this._setEventListeners()}}])&&W(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Y=new X(u,m),Z=new X(u,b),tt=new X(u,h),et=new j({nameSelector:".profile__name",jobSelector:".profile__occupation",avatarSelector:".profile__avatar"}),nt=new n("https://mesto.nomoreparties.co/v1/","bfea2fb3-1d49-4e0a-bbc4-333aa2efb088");function rt(t){return new _(t,nt.getUser(),r,(function(t){var e=t.name,n=t.link;return it.open({name:e,link:n})}),(function(t,e){st.open(t,e)}),(function(t,e,n){t.target.classList.contains("element__fav_active")?nt.removeLike(e).then((function(t){n.textContent=t.likes.length})):nt.addLike(e).then((function(t){n.textContent=t.likes.length})),t.target.classList.toggle("element__fav_active")})).generateCard()}nt.getUser().then((function(t){return et.setUserInfo(t)}));var ot=new w({items:nt.getCards(),renderer:function(t){ot.addItem(rt(t))}},".elements"),it=new B(".popup_type_image"),ut=new N(".popup_type_profile",(function(t){var e=t.name,n=t.about;ut.renderLoading(!0),nt.editUser({name:e,about:n}).then((function(t){et.editUserInfo(t)})).finally((function(){ut.close(),ut.renderLoading(!1)}))})),at=new N(".popup_type_place",(function(t){var e=t.placeName,n=t.placeImage;at.renderLoading(!0),nt.addCard({name:e,link:n}).then((function(t){ot.addItem(rt(t))})).finally((function(){at.renderLoading(!1),at.close()}))})),ct=new N(".popup_type_avatar",(function(t){nt.editUserAvatar(t).then((function(){ct.renderLoading(!0),et.editUserAvatar(t)})).finally((function(){ct.renderLoading(!1),ct.close()}))})),st=new G(".popup_type_confirm",(function(t,e){nt.removeCard(t).then((function(){e.remove(),e=null,st.close()}))}));ot.renderItems(),c.addEventListener("mousedown",(function(){nt.getUser().then((function(t){var e=et.getUserInfo(t),n=e.name,r=e.about;s.value=n,l.value=r,Y.setButtonState(),ut.open()}))})),f.addEventListener("click",(function(){return at.open()})),a.addEventListener("mousedown",(function(){return ct.open()})),ut.setEventListeners(),at.setEventListeners(),it.setEventListeners(),ct.setEventListeners(),Y.enableValidation(),Z.enableValidation(),tt.enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UixlQUFjLEdBQ2pDbEIsR0FBUzJCLGVBQWV0TCxFQUMxQixJQUNDZ0wsU0FBUSxXQUNQSyxHQUFtQlIsZUFBYyxHQUNqQ1EsR0FBbUJqRixPQUNyQixHQUNGLElBR0k4RCxHQUFtQixJQUFJckMsRVRySU8sdUJTdUlsQyxTQUFDMUgsRUFBUTZDLEdBQ1A0RyxHQUFJMkIsV0FBV3BMLEdBQVFyQixNQUFLLFdBQzFCa0UsRUFBUWtCLFNBQ1JsQixFQUFVLEtBQ1ZrSCxHQUFpQjlELE9BQ25CLEdBQ0YsSUFHRnFFLEdBQVVlLGNBRVZ0SyxFQUE0QndDLGlCQUFpQixhQUFhLFdBQ3hEa0csR0FBSUcsVUFBVWpMLE1BQUssU0FBQ2tGLEdBQ2xCLElBQUF5SCxFQUF3QjlCLEdBQVMrQixZQUFZMUgsR0FBckN0RSxFQUFJK0wsRUFBSi9MLEtBQU1DLEVBQUs4TCxFQUFMOUwsTUFDZHdCLEVBQVUxQyxNQUFRaUIsRUFDbEIwQixFQUFTM0MsTUFBUWtCLEVBQ2pCNkosRUFBc0JmLGlCQUN0Qm1DLEdBQWtCWCxNQUNwQixHQUNGLElBRUE1SSxFQUE2QnFDLGlCQUFpQixTQUFTLGtCQUNyRHVILEdBQW1CaEIsTUFBTSxJQUczQmxKLEVBQWlCMkMsaUJBQWlCLGFBQWEsa0JBQU0ySCxHQUFtQnBCLE1BQU0sSUFFOUVXLEdBQWtCZSxvQkFDbEJWLEdBQW1CVSxvQkFDbkIzQixHQUFlMkIsb0JBQ2ZOLEdBQW1CTSxvQkFHbkJuQyxFQUFzQm9DLG1CQUN0Qm5DLEVBQW9CbUMsbUJBQ3BCbEMsR0FBcUJrQyxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1NlY2l0b24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSAnaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC02Myc7XHJcbiAgICB0aGlzLl90b2tlbiA9ICdiZmVhMmZiMy0xZDQ5LTRlMGEtYmJjNC0zMzNhYTJlZmIwODgnO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlcigpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXIoeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VyQXZhdGFyKGF2YXRhck9iaikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYXZhdGFyT2JqKVxyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG5cclxuICBnZXRDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4gY29uc29sZS5sb2cocmVzKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gIH1cclxuXHJcbiAgYWRkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfVxyXG59XHJcbiIsIlxyXG5leHBvcnQgY29uc3QgcG9wdXBQbGFjZVNlbGVjdG9yID0gJy5wb3B1cF90eXBlX3BsYWNlJztcclxuZXhwb3J0IGNvbnN0IHBvcHVwUHJvZmlsZVNlbGVjdG9yID0gJy5wb3B1cF90eXBlX3Byb2ZpbGUnO1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZVNlbGVjdG9yID0gJy5wb3B1cF90eXBlX2ltYWdlJztcclxuZXhwb3J0IGNvbnN0IHBvcHVwTmV3QXZhdGFyU2VsZWN0b3IgPSAnLnBvcHVwX3R5cGVfYXZhdGFyJztcclxuZXhwb3J0IGNvbnN0IHBvcHVwQ29uZmlybVNlbGVjdG9yID0gJy5wb3B1cF90eXBlX2NvbmZpcm0nO1xyXG5cclxuZXhwb3J0IGNvbnN0IHVzZXJOYW1lID0gJy5wcm9maWxlX19uYW1lJztcclxuZXhwb3J0IGNvbnN0IHVzZXJKb2IgPSAnLnByb2ZpbGVfX29jY3VwYXRpb24nO1xyXG5leHBvcnQgY29uc3QgdXNlckF2YXRhciA9ICcucHJvZmlsZV9fYXZhdGFyJ1xyXG5cclxuZXhwb3J0IGNvbnN0IGVsZW1lbnRzQ29udGFpbmVyID0gJy5lbGVtZW50cyc7XHJcbmV4cG9ydCBjb25zdCBlbGVtZW50c1RlbXBsYXRlID0gJy5lbGVtZW50c19fdGVtcGxhdGUnO1xyXG5leHBvcnQgY29uc3QgZWxlbWVudFNlbGVjdG9yID0gJy5lbGVtZW50JztcclxuZXhwb3J0IGNvbnN0IGVsZW1lbnRJbWFnZVNlbGVjdG9yID0gJy5lbGVtZW50X19pbWFnZSc7XHJcbmV4cG9ydCBjb25zdCBlbGVtZW50Q2FwdGlvblNlbGVjdG9yID0gJy5lbGVtZW50X190ZXh0J1xyXG5leHBvcnQgY29uc3QgZWxlbWVudExpa2VDb3VudGVyID0gJy5lbGVtZW50X19mYXYtY291bnRlcidcclxuZXhwb3J0IGNvbnN0IHJlbW92ZUJ1dHRvblNlbGVjdG9yID0gJy5lbGVtZW50X19iaW4nO1xyXG5leHBvcnQgY29uc3QgZmF2QnV0dG9uU2VsZWN0b3IgPSAnLmVsZW1lbnRfX2Zhdic7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIuZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX3N1Ym1pdC1idXR0b25fYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl92aXNpYmxlXCIsXHJcbiAgaW5wdXRFcnJvckJvcmRlcjogXCJmb3JtX19pbnB1dF9lcnJvclwiLFxyXG59XHJcblxyXG4vLyDQmtC90L7Qv9C60LAg0LjQt9C80LXQvdC10L3QuNGPINCw0LLQsNGC0LDRgNCwXHJcbmV4cG9ydCBjb25zdCBlZHRpQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1jb250YWluZXInKVxyXG4vLyDQmtC90L7Qv9C60LAg0Lgg0YTQvtGA0LzQsCDQv9C+0L/QsNC/INC/0YDQvtGE0LjQu9GPXHJcbmV4cG9ydCBjb25zdCBwb3B1cFdpdGhVc2VySW5mb09wZW5CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICcucHJvZmlsZV9fYnV0dG9uLWNoYW5nZSdcclxuKTtcclxuZXhwb3J0IGNvbnN0IGlucHV0TGlzdFNlbGVjdG9yID0gJy5mb3JtX19pbnB1dCc7XHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBqb2JJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19pbnB1dF90eXBlX29jY3VwYXRpb24nKTtcclxuLy8g0JrQvdC+0L/QutCwINC4INC40L3Qv9GD0YLRiyDQv9C+0L/QsNC/INC90L7QstC+0LUg0LzQtdGB0YLQvlxyXG5leHBvcnQgY29uc3QgcG9wdXBXaXRoUGxhY2VJbmZvT3BlbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgJy5wcm9maWxlX19idXR0b24tYWRkJ1xyXG4pO1xyXG5leHBvcnQgY29uc3QgZWxlbWVudEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgZWxlbWVudEltYWdlQ2FwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgJy5wb3B1cF9faW1hZ2UtY2FwdGlvbidcclxuKTtcclxuZXhwb3J0IGNvbnN0IGZvcm1TZWxlY3RvciA9ICcuZm9ybSc7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zWydwcm9maWxlLWZvcm0nXTtcclxuZXhwb3J0IGNvbnN0IHBsYWNlRm9ybSA9IGRvY3VtZW50LmZvcm1zWydwbGFjZS1mb3JtJ107XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ2F2YXRhci1mb3JtJ11cclxuIiwiaW1wb3J0IHtcclxuICBlbGVtZW50Q2FwdGlvblNlbGVjdG9yLFxyXG4gIGVsZW1lbnRJbWFnZVNlbGVjdG9yLFxyXG4gIGVsZW1lbnRTZWxlY3RvcixcclxuICBlbGVtZW50TGlrZUNvdW50ZXIsXHJcbiAgZmF2QnV0dG9uU2VsZWN0b3IsXHJcbiAgcmVtb3ZlQnV0dG9uU2VsZWN0b3IsXHJcbn0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBnZXRDdXJyZW50VXNlcixcclxuICAgIHRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgICBvcGVuSW1hZ2VQb3B1cCxcclxuICAgIG9wZW5Db25maXJtUG9wdXAsXHJcbiAgICBsaWtlSGFuZGxlclxyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9saWtlSGFuZGxlciA9IGxpa2VIYW5kbGVyO1xyXG4gICAgdGhpcy5fY2FyZElkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9nZXRDdXJyZW50VXNlciA9IGdldEN1cnJlbnRVc2VyO1xyXG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9vcGVuSW1hZ2VQb3B1cCA9IG9wZW5JbWFnZVBvcHVwO1xyXG4gICAgdGhpcy5fb3BlbkNvbmZpcm1Qb3B1cCA9IG9wZW5Db25maXJtUG9wdXA7XHJcbiAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50SW1hZ2VTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9saWtlQ291bnRlciA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnRMaWtlQ291bnRlcik7XHJcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24gPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50Q2FwdGlvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3JlbW92ZUljb24gPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2JpbicpO1xyXG4gICAgdGhpcy5fZmF2QnV0dG9uID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZmF2QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudFNlbGVjdG9yKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHJlbW92ZUJ1dHRvblNlbGVjdG9yKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PlxyXG4gICAgICAgIHRoaXMuX29wZW5Db25maXJtUG9wdXAodGhpcy5fY2FyZElkLCB0aGlzLmVsZW1lbnQpXHJcbiAgICAgICk7XHJcbiAgICB0aGlzLmVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoZmF2QnV0dG9uU2VsZWN0b3IpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+XHJcbiAgICAgICAgdGhpcy5fbGlrZUhhbmRsZXIoZXZ0LCB0aGlzLl9jYXJkSWQsIHRoaXMuX2xpa2VDb3VudGVyKVxyXG4gICAgICApO1xyXG4gICAgdGhpcy5lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKGVsZW1lbnRJbWFnZVNlbGVjdG9yKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgdGhpcy5fb3BlbkltYWdlUG9wdXAoeyBuYW1lOiBldnQudGFyZ2V0LmFsdCwgbGluazogZXZ0LnRhcmdldC5zcmMgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZ2V0Q3VycmVudFVzZXIudGhlbigodXNlcikgPT4ge1xyXG4gICAgICBpZiAodXNlci5faWQgPT09IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgICB0aGlzLl9yZW1vdmVJY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2Rpc2FibGVkJyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuX2xpa2VzLmZpbmQoKGVsKSA9PiBlbC5faWQgPT09IHVzZXIuX2lkKSkge1xyXG4gICAgICAgIHRoaXMuX2ZhdkJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50X19mYXZfYWN0aXZlJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2xpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgIHRoaXMuX2l0ZW1zLnRoZW4oaXRlbXMgPT4ge1xyXG4gICAgaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSlcclxuICAgIH0pO1xyXG4gICB9KVxyXG4gICAgXHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpe1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudClcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgICB0aGlzLnVzZXIgPSB7fTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHVzZXIpIHtcclxuICAgICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IHVzZXIubmFtZTtcclxuICAgICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSB1c2VyLmFib3V0O1xyXG4gICAgICB0aGlzLl9hdmF0YXIuc3JjID0gdXNlci5hdmF0YXI7XHJcbiAgICAgIHRoaXMuX2lkID0gdXNlci5faWQ7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbyh1c2VyKSB7XHJcbiAgICB0aGlzLnVzZXIubmFtZSA9IHVzZXIubmFtZTtcclxuICAgIHRoaXMudXNlci5hYm91dCA9IHVzZXIuYWJvdXQ7XHJcbiAgICB0aGlzLnVzZXIuYXZhdGFyID0gdXNlci5hdmF0YXI7XHJcbiAgICB0aGlzLnVzZXIuaWQgPSB1c2VyLl9pZDtcclxuICAgIHJldHVybiB0aGlzLnVzZXI7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckF2YXRhcih7YXZhdGFyfSkge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFBvcHVwe1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3Ipe1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpXHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpXHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIG9wZW4oKXtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSlcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIilcclxuICB9XHJcblxyXG4gIGNsb3NlKCl7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpXHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpXHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpe1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KT0+e1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX29wZW5lZCcpIHx8XHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZS1pY29uJylcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKVxyXG4gIH1cclxufSIsImltcG9ydCB7IGVsZW1lbnRJbWFnZSwgZWxlbWVudEltYWdlQ2FwdGlvbiB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcil7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oe25hbWUsIGxpbmt9KXtcclxuICAgIHN1cGVyLm9wZW4oKVxyXG4gICAgZWxlbWVudEltYWdlLnNyYyA9IGxpbms7XHJcbiAgICBlbGVtZW50SW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIGVsZW1lbnRJbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gIH1cclxufSIsImltcG9ydCB7IGZvcm1TZWxlY3RvciwgaW5wdXRMaXN0U2VsZWN0b3IsIGNvbmZpZyB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcyc7XHJcbmltcG9ydCB7IFBvcHVwIH0gZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXRGb3JtKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0gPSBoYW5kbGVTdWJtaXRGb3JtO1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoZm9ybVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKGlucHV0TGlzdFNlbGVjdG9yKSk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKVxyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5yZWR1Y2UoKGFjYywgY3VyKSA9PiB7XHJcbiAgICAgIGFjY1tjdXIubmFtZV0gPSBjdXIudmFsdWU7XHJcbiAgICAgIHJldHVybiBhY2M7XHJcbiAgICB9LCB7fSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZyl7XHJcbiAgICBpZihpc0xvYWRpbmcpe1xyXG4gICAgICBjb25zb2xlLmxvZyh0aGlzLl9zdWJtaXRCdXR0b24pXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLidcclxuICAgIH1lbHNlIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0odGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKXtcclxuICAgIHN1cGVyLm9wZW4oKVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gJy4vUG9wdXAnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLmZvcm1fX3N1Ym1pdC1idXR0b24nKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdFxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQodGhpcy5fY2FyZElkLCB0aGlzLl9lbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihjYXJkSWQsIGVsZW1lbnQpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX2NhcmRJZCA9IGNhcmRJZDtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRpb24ge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fb3B0aW9ucy5pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fb3B0aW9ucy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICB9XHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4gZXZ0LnByZXZlbnREZWZhdWx0KCkpO1xyXG5cclxuICAgIC8v0KHQsdGA0L7RgSDRgdC+0YHRgtC+0Y/QvdC40Y8g0LrQvdC+0L/QutC4LCDQv9C+0YHQu9C1INGB0LDQsdC80LjRgtCwXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdyZXNldCcsICgpID0+IHtcclxuICAgICAgc2V0VGltZW91dChcclxuICAgICAgICAoKSA9PiB0aGlzLnNldEJ1dHRvblN0YXRlKCksXHJcbiAgICAgICAgMFxyXG4gICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy/Qn9GA0L7QstC10YDQutCwINCy0YHQtdGFINC40L3Qv9GD0YLQvtCyINC4INGD0YHRgtCw0L3QvtCy0LrQsCDRgdC+0YHRgtC+0Y/QvdC40Y8g0LrQvdC+0L/QutC4XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9vcHRpb25zLmlucHV0U2VsZWN0b3IpXHJcbiAgICAgIC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgICAgdGhpcy5zZXRCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgfVxyXG5cclxuICBzZXRCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9nZXRJbnB1dFN0YXR1cyh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fb3B0aW9ucy5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX29wdGlvbnMuYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy/Qv9GA0L7QstC10YDQutCwINCy0YHQtdGFINC40L3Qv9GD0YLQvtCyINGE0L7RgNC80YtcclxuICBfZ2V0SW5wdXRTdGF0dXMoaW5wdXRMaXN0KSB7XHJcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiAhaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgLy/Qo9GB0YLQsNC90L7QstC60LBcXNGD0LTQsNC70LXQvdC40LUg0L/QvtC70Y8g0YEg0L7RiNC40LHQutC+0LlcclxuICBfdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgICAgPyB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXHJcbiAgICAgIDogdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIC8v0JLRi9Cx0L7RgCDQvdGD0LbQvdC+0LPQviBzcGFuINGBINC+0YjQuNCx0LrQvtC5XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50Lm5hbWV9LWlucHV0LWVycm9yYFxyXG4gICAgKTtcclxuXHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9vcHRpb25zLmVycm9yQ2xhc3MpO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fb3B0aW9ucy5pbnB1dEVycm9yQm9yZGVyKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQubmFtZX0taW5wdXQtZXJyb3JgXHJcbiAgICApO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fb3B0aW9ucy5lcnJvckNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX29wdGlvbnMuaW5wdXRFcnJvckJvcmRlcik7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQXBpIH0gZnJvbSAnLi4vY29tcG9uZW50cy9BcGkuanMnO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSAnLi4vY29tcG9uZW50cy9DYXJkLmpzJztcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gJy4uL2NvbXBvbmVudHMvU2VjaXRvbi5qcyc7XHJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mby5qcyc7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyc7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhDb25maXJtYXRpb24gfSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyc7XHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0aW9uIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdGlvbi5qcyc7XHJcbmltcG9ydCB7XHJcbiAgZWxlbWVudHNDb250YWluZXIsXHJcbiAgZWxlbWVudHNUZW1wbGF0ZSxcclxuICBqb2JJbnB1dCxcclxuICBuYW1lSW5wdXQsXHJcbiAgcGxhY2VGb3JtLFxyXG4gIGF2YXRhckZvcm0sXHJcbiAgcG9wdXBJbWFnZVNlbGVjdG9yLFxyXG4gIHBvcHVwUGxhY2VTZWxlY3RvcixcclxuICBwb3B1cFByb2ZpbGVTZWxlY3RvcixcclxuICBwb3B1cE5ld0F2YXRhclNlbGVjdG9yLFxyXG4gIHBvcHVwV2l0aFBsYWNlSW5mb09wZW5CdXR0b24sXHJcbiAgcG9wdXBXaXRoVXNlckluZm9PcGVuQnV0dG9uLFxyXG4gIHByb2ZpbGVGb3JtLFxyXG4gIHVzZXJKb2IsXHJcbiAgdXNlck5hbWUsXHJcbiAgdXNlckF2YXRhcixcclxuICBwb3B1cENvbmZpcm1TZWxlY3RvcixcclxuICBlZHRpQXZhdGFyQnV0dG9uLFxyXG59IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcyc7XHJcbmltcG9ydCB7Y29uZmlnfSBmcm9tICcuLi91dGlscy9jb25zdGFudHMuanMnXHJcbmltcG9ydCAnLi4vLi4vcGFnZXMvaW5kZXguY3NzJztcclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdGlvbihjb25maWcsIHByb2ZpbGVGb3JtKTtcclxuY29uc3QgcGxhY2VGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdGlvbihjb25maWcsIHBsYWNlRm9ybSk7XHJcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0aW9uKGNvbmZpZywgYXZhdGFyRm9ybSk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiB1c2VyTmFtZSxcclxuICBqb2JTZWxlY3RvcjogdXNlckpvYixcclxuICBhdmF0YXJTZWxlY3RvcjogdXNlckF2YXRhcixcclxufSk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKFxyXG4gICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvJyxcclxuICAnYmZlYTJmYjMtMWQ0OS00ZTBhLWJiYzQtMzMzYWEyZWZiMDg4J1xyXG4pO1xyXG5cclxuLy8g0JfQsNC/0L7Qu9C90LXQvdC40LUg0L/RgNC+0YTQuNC70Y9cclxuYXBpLmdldFVzZXIoKS50aGVuKCh1c2VyKSA9PiB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyKSk7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKHBsYWNlKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgcGxhY2UsXHJcbiAgICBhcGkuZ2V0VXNlcigpLFxyXG4gICAgZWxlbWVudHNUZW1wbGF0ZSxcclxuICAgICh7IG5hbWUsIGxpbmsgfSkgPT4gcG9wdXBXaXRoSW1hZ2Uub3Blbih7IG5hbWUsIGxpbmsgfSksXHJcbiAgICAvLyDQn9C10YDQtdC00LDRh9CwINC00LDQvdC90YvRhSDQviDQutCw0YDRgtC+0YfQutC1INC4INGN0LvQtdC80LXQvdGC0LUg0LrQsNGA0YLQvtGH0LrQuCDQsiDQv9C+0L/QsNC/XHJcbiAgICAoY2FyZElkLCBlbGVtZW50KSA9PiB7XHJcbiAgICAgIHBvcHVwV2l0aENvbmZpcm0ub3BlbihjYXJkSWQsIGVsZW1lbnQpO1xyXG4gICAgfSxcclxuICAgIChldnQsIGNhcmRJZCwgbGlrZUNvdW50ZXIpID0+IHtcclxuICAgICAgaWYgKCFldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZWxlbWVudF9fZmF2X2FjdGl2ZScpKSB7XHJcbiAgICAgICAgYXBpLmFkZExpa2UoY2FyZElkKS50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xyXG4gICAgICAgICAgbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB1cGRhdGVkQ2FyZC5saWtlcy5sZW5ndGg7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXBpLnJlbW92ZUxpa2UoY2FyZElkKS50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xyXG4gICAgICAgICAgbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB1cGRhdGVkQ2FyZC5saWtlcy5sZW5ndGg7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9fZmF2X2FjdGl2ZScpO1xyXG4gICAgfVxyXG4gICkuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgcmV0dXJuIGNhcmQ7XHJcbn1cclxuXHJcbmNvbnN0IHBsYWNlTGlzdCA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBhcGkuZ2V0Q2FyZHMoKSxcclxuICAgIHJlbmRlcmVyOiAocGxhY2UpID0+IHtcclxuICAgICAgcGxhY2VMaXN0LmFkZEl0ZW0oY3JlYXRlQ2FyZChwbGFjZSkpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGVsZW1lbnRzQ29udGFpbmVyXHJcbik7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cEltYWdlU2VsZWN0b3IpO1xyXG5cclxuY29uc3QgcG9wdXBXaXRoVXNlckluZm8gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBwb3B1cFByb2ZpbGVTZWxlY3RvcixcclxuICAoeyBuYW1lLCBhYm91dCB9KSA9PiB7XHJcbiAgICBwb3B1cFdpdGhVc2VySW5mby5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5lZGl0VXNlcih7IG5hbWUsIGFib3V0IH0pXHJcbiAgICAgIC50aGVuKCh1c2VyKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uZWRpdFVzZXJJbmZvKHVzZXIpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgcG9wdXBXaXRoVXNlckluZm8uY2xvc2UoKTtcclxuICAgICAgICBwb3B1cFdpdGhVc2VySW5mby5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4pO1xyXG5cclxuY29uc3QgcG9wdXBXaXRoUGxhY2VJbmZvID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgcG9wdXBQbGFjZVNlbGVjdG9yLFxyXG4gICh7IHBsYWNlTmFtZSwgcGxhY2VJbWFnZSB9KSA9PiB7XHJcbiAgICAvLyDQodC+0YXRgNCw0L3QtdC90LjQtS4uLi5cclxuICAgIHBvcHVwV2l0aFBsYWNlSW5mby5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG5cclxuICAgIGFwaS5hZGRDYXJkKHtcclxuICAgICAgICBuYW1lOiBwbGFjZU5hbWUsXHJcbiAgICAgICAgbGluazogcGxhY2VJbWFnZSxcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4oKHBsYWNlKSA9PiB7XHJcbiAgICAgICAgcGxhY2VMaXN0LmFkZEl0ZW0oY3JlYXRlQ2FyZChwbGFjZSkpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgcG9wdXBXaXRoUGxhY2VJbmZvLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgIHBvcHVwV2l0aFBsYWNlSW5mby5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbik7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhOZXdBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBwb3B1cE5ld0F2YXRhclNlbGVjdG9yLFxyXG4gIChhdmF0YXJPYmopID0+IHtcclxuICAgIGFwaS5lZGl0VXNlckF2YXRhcihhdmF0YXJPYmopLnRoZW4oKCkgPT4ge1xyXG4gICAgICBwb3B1cFdpdGhOZXdBdmF0YXIucmVuZGVyTG9hZGluZyh0cnVlKVxyXG4gICAgICB1c2VySW5mby5lZGl0VXNlckF2YXRhcihhdmF0YXJPYmopO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpPT4ge1xyXG4gICAgICBwb3B1cFdpdGhOZXdBdmF0YXIucmVuZGVyTG9hZGluZyhmYWxzZSlcclxuICAgICAgcG9wdXBXaXRoTmV3QXZhdGFyLmNsb3NlKClcclxuICAgIH0pO1xyXG4gIH1cclxuKTtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aENvbmZpcm0gPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFxyXG4gIHBvcHVwQ29uZmlybVNlbGVjdG9yLFxyXG4gIChjYXJkSWQsIGVsZW1lbnQpID0+IHtcclxuICAgIGFwaS5yZW1vdmVDYXJkKGNhcmRJZCkudGhlbigoKSA9PiB7XHJcbiAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgIGVsZW1lbnQgPSBudWxsO1xyXG4gICAgICBwb3B1cFdpdGhDb25maXJtLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbik7XHJcblxyXG5wbGFjZUxpc3QucmVuZGVySXRlbXMoKTtcclxuXHJcbnBvcHVwV2l0aFVzZXJJbmZvT3BlbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoKSA9PiB7XHJcbiAgYXBpLmdldFVzZXIoKS50aGVuKCh1c2VyKSA9PiB7XHJcbiAgICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbyh1c2VyKTtcclxuICAgIG5hbWVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgICBqb2JJbnB1dC52YWx1ZSA9IGFib3V0O1xyXG4gICAgcHJvZmlsZUZvcm1WYWxpZGF0aW9uLnNldEJ1dHRvblN0YXRlKCk7XHJcbiAgICBwb3B1cFdpdGhVc2VySW5mby5vcGVuKCk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxucG9wdXBXaXRoUGxhY2VJbmZvT3BlbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+XHJcbiAgcG9wdXBXaXRoUGxhY2VJbmZvLm9wZW4oKVxyXG4pO1xyXG5cclxuZWR0aUF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoKSA9PiBwb3B1cFdpdGhOZXdBdmF0YXIub3BlbigpKTtcclxuXHJcbnBvcHVwV2l0aFVzZXJJbmZvLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnBvcHVwV2l0aFBsYWNlSW5mby5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wb3B1cFdpdGhOZXdBdmF0YXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8v0JLQsNC70LjQtNCw0YbQuNGPINGE0L7RgNC8XHJcbnByb2ZpbGVGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbnBsYWNlRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiJdLCJuYW1lcyI6WyJBcGkiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfdG9rZW4iLCJrZXkiLCJ2YWx1ZSIsImZldGNoIiwiY29uY2F0IiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsIl9yZWYiLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImF2YXRhck9iaiIsIl9yZWYyIiwibGluayIsImNhcmRJZCIsImVsZW1lbnRzVGVtcGxhdGUiLCJlbGVtZW50SW1hZ2VTZWxlY3RvciIsImZhdkJ1dHRvblNlbGVjdG9yIiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaW5wdXRFcnJvckJvcmRlciIsImVkdGlBdmF0YXJCdXR0b24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwb3B1cFdpdGhVc2VySW5mb09wZW5CdXR0b24iLCJuYW1lSW5wdXQiLCJqb2JJbnB1dCIsInBvcHVwV2l0aFBsYWNlSW5mb09wZW5CdXR0b24iLCJlbGVtZW50SW1hZ2UiLCJlbGVtZW50SW1hZ2VDYXB0aW9uIiwicHJvZmlsZUZvcm0iLCJmb3JtcyIsInBsYWNlRm9ybSIsImF2YXRhckZvcm0iLCJDYXJkIiwiZGF0YSIsImdldEN1cnJlbnRVc2VyIiwidGVtcGxhdGVTZWxlY3RvciIsIm9wZW5JbWFnZVBvcHVwIiwib3BlbkNvbmZpcm1Qb3B1cCIsImxpa2VIYW5kbGVyIiwiX25hbWUiLCJfbGluayIsIl9saWtlcyIsImxpa2VzIiwiX2xpa2VIYW5kbGVyIiwiX2NhcmRJZCIsIl9pZCIsIl9vd25lcklkIiwib3duZXIiLCJfZ2V0Q3VycmVudFVzZXIiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9vcGVuSW1hZ2VQb3B1cCIsIl9vcGVuQ29uZmlybVBvcHVwIiwiZWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsIl9pbWFnZSIsIl9saWtlQ291bnRlciIsIl9pbWFnZUNhcHRpb24iLCJfcmVtb3ZlSWNvbiIsIl9mYXZCdXR0b24iLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3RoaXMiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwidGFyZ2V0IiwiYWx0Iiwic3JjIiwiX3RoaXMyIiwidXNlciIsImNsYXNzTGlzdCIsInJlbW92ZSIsImZpbmQiLCJlbCIsInRvZ2dsZSIsIl9zZXRFdmVudExpc3RlbmVycyIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJmb3JFYWNoIiwiaXRlbSIsInByZXBlbmQiLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfYWJvdXQiLCJfYXZhdGFyIiwiYXZhdGFyIiwiaWQiLCJfcmVmMyIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIndpbmRvdyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjQ2xvc2UiLCJfcG9wdXAiLCJhZGQiLCJjb250YWlucyIsImNsb3NlIiwiUG9wdXBXaXRoSW1hZ2UiLCJfUG9wdXAiLCJfaW5oZXJpdHMiLCJfc3VwZXIiLCJjYWxsIiwiX2dldCIsIl9nZXRQcm90b3R5cGVPZiIsInByb3RvdHlwZSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXRGb3JtIiwiX2hhbmRsZVN1Ym1pdEZvcm0iLCJfZm9ybSIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsInJlZHVjZSIsImFjYyIsImN1ciIsImlzTG9hZGluZyIsInByZXZlbnREZWZhdWx0IiwiX2dldElucHV0VmFsdWVzIiwicmVzZXQiLCJQb3B1cFdpdGhDb25maXJtYXRpb24iLCJoYW5kbGVTdWJtaXQiLCJfYnV0dG9uIiwiX2hhbmRsZVN1Ym1pdCIsIl9lbGVtZW50IiwiRm9ybVZhbGlkYXRpb24iLCJvcHRpb25zIiwiZm9ybUVsZW1lbnQiLCJfb3B0aW9ucyIsIl9mb3JtRWxlbWVudCIsIl9idXR0b25FbGVtZW50Iiwic2V0VGltZW91dCIsInNldEJ1dHRvblN0YXRlIiwiaW5wdXRFbGVtZW50IiwiX3RvZ2dsZUlucHV0RXJyb3IiLCJfZ2V0SW5wdXRTdGF0dXMiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbnB1dExpc3QiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JFbGVtZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJwcm9maWxlRm9ybVZhbGlkYXRpb24iLCJwbGFjZUZvcm1WYWxpZGF0aW9uIiwiYXZhdGFyRm9ybVZhbGlkYXRpb24iLCJ1c2VySW5mbyIsImFwaSIsImNyZWF0ZUNhcmQiLCJwbGFjZSIsImdldFVzZXIiLCJwb3B1cFdpdGhJbWFnZSIsIm9wZW4iLCJwb3B1cFdpdGhDb25maXJtIiwibGlrZUNvdW50ZXIiLCJyZW1vdmVMaWtlIiwidXBkYXRlZENhcmQiLCJhZGRMaWtlIiwiZ2VuZXJhdGVDYXJkIiwic2V0VXNlckluZm8iLCJwbGFjZUxpc3QiLCJnZXRDYXJkcyIsImFkZEl0ZW0iLCJwb3B1cFdpdGhVc2VySW5mbyIsInJlbmRlckxvYWRpbmciLCJlZGl0VXNlciIsImVkaXRVc2VySW5mbyIsImZpbmFsbHkiLCJwb3B1cFdpdGhQbGFjZUluZm8iLCJwbGFjZU5hbWUiLCJwbGFjZUltYWdlIiwiYWRkQ2FyZCIsInBvcHVwV2l0aE5ld0F2YXRhciIsImVkaXRVc2VyQXZhdGFyIiwicmVtb3ZlQ2FyZCIsInJlbmRlckl0ZW1zIiwiX3VzZXJJbmZvJGdldFVzZXJJbmZvIiwiZ2V0VXNlckluZm8iLCJzZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9