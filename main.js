(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===t(i)?i:String(i)),o)}var i}var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl="https://mesto.nomoreparties.co/v1/cohort-63",this._token="bfea2fb3-1d49-4e0a-bbc4-333aa2efb088"}var n,r;return n=t,(r=[{key:"getUser",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"editUser",value:function(t){var e=t.name,n=t.about;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:n})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"editUserAvatar",value:function(t){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"getCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"addCard",value:function(t){var e=t.name,n=t.link;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:n})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"removeCard",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t),{method:"DELETE",headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).then((function(t){return console.log(t)})).catch((function(t){return console.log(t)}))}},{key:"addLike",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"PUT",headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}},{key:"removeLike",value:function(t){return fetch("".concat(this._baseUrl,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:{authorization:this._token}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){return console.log(t)}))}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(),r=".elements__template",o=".element__image",i=".element__fav",u={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".popup__submit-button",activeButtonClass:"popup__submit-button_active",inputErrorClass:"form__input-error",errorClass:"form__input-error_visible",inputErrorBorder:"form__input_error"},a=document.querySelector(".profile__avatar-container"),c=document.querySelector(".profile__button-change"),s=document.querySelector(".form__input_type_name"),l=document.querySelector(".form__input_type_occupation"),f=document.querySelector(".profile__button-add"),p=document.querySelector(".popup__image"),y=document.querySelector(".popup__image-caption"),m=document.forms["profile-form"],v=document.forms["place-form"],h=document.forms["avatar-form"];function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==b(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===b(o)?o:String(o)),r)}var o}var _=function(){function t(e,n,r,u,a,c){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e.name,this._link=e.link,this._likes=e.likes,this._likeHandler=c,this._cardId=e._id,this._ownerId=e.owner._id,this._getCurrentUser=n,this._templateSelector=r,this._openImagePopup=u,this._openConfirmPopup=a,this.element=this._getTemplate(),this._image=this.element.querySelector(o),this._likeCounter=this.element.querySelector(".element__fav-counter"),this._imageCaption=this.element.querySelector(".element__text"),this._removeIcon=this.element.querySelector(".element__bin"),this._favButton=this.element.querySelector(i)}var e,n;return e=t,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}},{key:"_setEventListeners",value:function(){var t=this;this.element.querySelector(".element__bin").addEventListener("click",(function(){return t._openConfirmPopup(t._cardId,t.element)})),this.element.querySelector(i).addEventListener("click",(function(e){return t._likeHandler(e,t._cardId,t._likeCounter)})),this.element.querySelector(o).addEventListener("click",(function(e){t._openImagePopup({name:e.target.alt,link:e.target.src})}))}},{key:"generateCard",value:function(){var t=this;return this._getCurrentUser.then((function(e){e._id===t._ownerId&&t._removeIcon.classList.remove("disabled"),t._likes.find((function(t){return t._id===e._id}))&&t._favButton.classList.toggle("element__fav_active")})),this._setEventListeners(),this._image.src=this._link,this._image.alt=this._name,this._imageCaption.textContent=this._name,this._likeCounter.textContent=this._likes.length,this.element}}])&&d(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==g(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===g(o)?o:String(o)),r)}var o}var w=function(){function t(e,n){var r=e.items,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderItems",value:function(){var t=this;this._items.then((function(e){e.forEach((function(e){t._renderer(e)}))}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&S(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==k(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===k(o)?o:String(o)),r)}var o}var j=function(){function t(e){var n=e.nameSelector,r=e.jobSelector,o=e.avatarSelector;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=document.querySelector(n),this._about=document.querySelector(r),this._avatar=document.querySelector(o),this.user={}}var e,n;return e=t,(n=[{key:"setUserInfo",value:function(t){this._name.textContent=t.name,this._about.textContent=t.about,this._avatar.src=t.avatar,this._id=t._id}},{key:"getUserInfo",value:function(t){return this.user.name=t.name,this.user.about=t.about,this.user.avatar=t.avatar,this.user.id=t._id,this.user}},{key:"editUserInfo",value:function(t){var e=t.name,n=t.about;this._name.textContent=e,this._about.textContent=n}},{key:"editUserAvatar",value:function(t){var e=t.avatar;this._avatar.src=e}}])&&E(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,L(r.key),r)}}function L(t){var e=function(t,e){if("object"!==P(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===P(e)?e:String(e)}var C=function(){function t(e){var n,r,o,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=function(t){"Escape"===t.key&&(window.removeEventListener("keydown",i._handleEscClose),i._popup.classList.remove("popup_opened"))},(r=L(r="_handleEscClose"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this._popup=document.querySelector(e)}var e,n;return e=t,(n=[{key:"open",value:function(){window.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}},{key:"close",value:function(){window.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove("popup_opened")}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("mousedown",(function(e){(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close-icon"))&&t.close()})),window.addEventListener("keydown",this._handleEscClose)}}])&&O(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==T(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===T(o)?o:String(o)),r)}var o}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=R(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},q.apply(this,arguments)}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}function R(t){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},R(t)}var B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=R(r);if(o){var n=R(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===T(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,t)}return e=u,(n=[{key:"open",value:function(t){var e=t.name,n=t.link;q(R(u.prototype),"open",this).call(this),p.src=n,p.alt=e,y.textContent=e}}])&&I(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(C);function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==A(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===A(o)?o:String(o)),r)}var o}function D(){return D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=V(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},D.apply(this,arguments)}function z(t,e){return z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},z(t,e)}function V(t){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V(t)}var N=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&z(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=V(r);if(o){var n=V(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===A(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t))._handleSubmitForm=e,n._form=n._popup.querySelector(".form"),n._inputList=Array.from(n._form.querySelectorAll(".form__input")),n._submitButton=n._form.querySelector(u.submitButtonSelector),n}return e=a,(n=[{key:"_getInputValues",value:function(){return this._inputList.reduce((function(t,e){return t[e.name]=e.value,t}),{})}},{key:"renderLoading",value:function(t){this._submitButton.textContent=t?"Сохранение...":"Сохранить"}},{key:"setEventListeners",value:function(){var t=this;D(V(a.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(e){e.preventDefault(),t._handleSubmitForm(t._getInputValues())}))}},{key:"close",value:function(){D(V(a.prototype),"close",this).call(this),this._form.reset()}},{key:"open",value:function(){D(V(a.prototype),"open",this).call(this)}}])&&x(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(C);function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==H(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===H(o)?o:String(o)),r)}var o}function F(){return F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},F.apply(this,arguments)}function M(t,e){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},M(t,e)}function $(t){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$(t)}var G=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=$(r);if(o){var n=$(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===H(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t))._button=n._popup.querySelector(u.submitButtonSelector),n._handleSubmit=e,n}return e=a,(n=[{key:"_setEventListeners",value:function(){var t=this;F($(a.prototype),"setEventListeners",this).call(this),this._button.addEventListener("mousedown",(function(e){e.preventDefault(),t._handleSubmit(t._cardId,t._element)}))}},{key:"close",value:function(){F($(a.prototype),"close",this).call(this)}},{key:"open",value:function(t,e){F($(a.prototype),"open",this).call(this),this._cardId=t,this._element=e,this._setEventListeners()}}])&&J(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(C);function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==K(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===K(o)?o:String(o)),r)}var o}var X=function(){function t(e,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._options=e,this._formElement=n,this._inputList=function(t){if(Array.isArray(t))return Q(t)}(r=this._formElement.querySelectorAll(this._options.inputSelector))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return Q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),this._buttonElement=this._formElement.querySelector(this._options.submitButtonSelector)}var e,n;return e=t,(n=[{key:"_setEventListeners",value:function(){var t=this;this._formElement.addEventListener("submit",(function(t){return t.preventDefault()})),this._formElement.addEventListener("reset",(function(){setTimeout((function(){return t.setButtonState()}),0)})),this._formElement.querySelectorAll(this._options.inputSelector).forEach((function(e){return e.addEventListener("input",(function(){t._toggleInputError(e),t.setButtonState()}))}))}},{key:"setButtonState",value:function(){this._getInputStatus(this._inputList)?(this._buttonElement.setAttribute("disabled","disabled"),this._buttonElement.classList.remove(this._options.activeButtonClass)):(this._buttonElement.removeAttribute("disabled","disabled"),this._buttonElement.classList.add(this._options.activeButtonClass))}},{key:"_getInputStatus",value:function(t){return t.some((function(t){return!t.validity.valid}))}},{key:"_toggleInputError",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}},{key:"_showInputError",value:function(t){var e=this._formElement.querySelector(".".concat(t.name,"-input-error"));e.textContent=t.validationMessage,e.classList.add(this._options.errorClass),t.classList.add(this._options.inputErrorBorder)}},{key:"_hideInputError",value:function(t){this._formElement.querySelector(".".concat(t.name,"-input-error")).classList.remove(this._options.errorClass),t.classList.remove(this._options.inputErrorBorder)}},{key:"enableValidation",value:function(){this._setEventListeners()}}])&&W(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Y=new X(u,m),Z=new X(u,v),tt=new X(u,h),et=new j({nameSelector:".profile__name",jobSelector:".profile__occupation",avatarSelector:".profile__avatar"}),nt=new n("https://mesto.nomoreparties.co/v1/","bfea2fb3-1d49-4e0a-bbc4-333aa2efb088");function rt(t){return new _(t,nt.getUser(),r,(function(t){var e=t.name,n=t.link;return it.open({name:e,link:n})}),(function(t,e){st.open(t,e)}),(function(t,e,n){t.target.classList.contains("element__fav_active")?nt.removeLike(e).then((function(t){n.textContent=t.likes.length})):nt.addLike(e).then((function(t){n.textContent=t.likes.length})),t.target.classList.toggle("element__fav_active")})).generateCard()}nt.getUser().then((function(t){return et.setUserInfo(t)}));var ot=new w({items:nt.getCards(),renderer:function(t){ot.addItem(rt(t))}},".elements"),it=new B(".popup_type_image"),ut=new N(".popup_type_profile",(function(t){var e=t.name,n=t.about;ut.renderLoading(!0),nt.editUser({name:e,about:n}).then((function(t){et.editUserInfo(t)})).finally((function(){ut.close(),ut.renderLoading(!1)}))})),at=new N(".popup_type_place",(function(t){var e=t.placeName,n=t.placeImage;at.renderLoading(!0),nt.addCard({name:e,link:n}).then((function(t){ot.addItem(rt(t))})).finally((function(){at.renderLoading(!1),at.close()}))})),ct=new N(".popup_type_avatar",(function(t){nt.editUserAvatar(t).then((function(){ct.renderLoading(!0),et.editUserAvatar(t)})).finally((function(){ct.renderLoading(!1),ct.close()}))})),st=new G(".popup_type_confirm",(function(t,e){nt.removeCard(t).then((function(){e.remove(),e=null,st.close()}))}));ot.renderItems(),c.addEventListener("mousedown",(function(){nt.getUser().then((function(t){var e=et.getUserInfo(t),n=e.name,r=e.about;s.value=n,l.value=r,Y.setButtonState(),ut.open()}))})),f.addEventListener("click",(function(){return at.open()})),a.addEventListener("mousedown",(function(){return ct.open()})),ut.setEventListeners(),at.setEventListeners(),it.setEventListeners(),ct.setEventListeners(),Y.enableValidation(),Z.enableValidation(),tt.enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TCxTQUFRLFdBQ1BLLEdBQW1CUixlQUFjLEdBQ2pDUSxHQUFtQmpGLE9BQ3JCLEdBQ0YsSUFHSThELEdBQW1CLElBQUlyQyxFVHJJTyx1QlN1SWxDLFNBQUMxSCxFQUFRNkMsR0FDUDRHLEdBQUkyQixXQUFXcEwsR0FBUXJCLE1BQUssV0FDMUJrRSxFQUFRa0IsU0FDUmxCLEVBQVUsS0FDVmtILEdBQWlCOUQsT0FDbkIsR0FDRixJQUdGcUUsR0FBVWUsY0FFVnRLLEVBQTRCd0MsaUJBQWlCLGFBQWEsV0FDeERrRyxHQUFJRyxVQUFVakwsTUFBSyxTQUFDa0YsR0FDbEIsSUFBQXlILEVBQXdCOUIsR0FBUytCLFlBQVkxSCxHQUFyQ3RFLEVBQUkrTCxFQUFKL0wsS0FBTUMsRUFBSzhMLEVBQUw5TCxNQUNkd0IsRUFBVTFDLE1BQVFpQixFQUNsQjBCLEVBQVMzQyxNQUFRa0IsRUFDakI2SixFQUFzQmYsaUJBQ3RCbUMsR0FBa0JYLE1BQ3BCLEdBQ0YsSUFFQTVJLEVBQTZCcUMsaUJBQWlCLFNBQVMsa0JBQ3JEdUgsR0FBbUJoQixNQUFNLElBRzNCbEosRUFBaUIyQyxpQkFBaUIsYUFBYSxrQkFBTTJILEdBQW1CcEIsTUFBTSxJQUU5RVcsR0FBa0JlLG9CQUNsQlYsR0FBbUJVLG9CQUNuQjNCLEdBQWUyQixvQkFDZk4sR0FBbUJNLG9CQUduQm5DLEVBQXNCb0MsbUJBQ3RCbkMsRUFBb0JtQyxtQkFDcEJsQyxHQUFxQmtDLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjaXRvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9zY3JpcHRzL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTYzJztcclxuICAgIHRoaXMuX3Rva2VuID0gJ2JmZWEyZmIzLTFkNDktNGUwYS1iYmM0LTMzM2FhMmVmYjA4OCc7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VyKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlcih7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJBdmF0YXIoYXZhdGFyT2JqKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShhdmF0YXJPYmopXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gIH1cclxuXHJcblxyXG4gIGdldENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiBjb25zb2xlLmxvZyhyZXMpKVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiAnUFVUJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmICghcmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcbn1cclxuIiwiXHJcbmV4cG9ydCBjb25zdCBwb3B1cFBsYWNlU2VsZWN0b3IgPSAnLnBvcHVwX3R5cGVfcGxhY2UnO1xyXG5leHBvcnQgY29uc3QgcG9wdXBQcm9maWxlU2VsZWN0b3IgPSAnLnBvcHVwX3R5cGVfcHJvZmlsZSc7XHJcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlU2VsZWN0b3IgPSAnLnBvcHVwX3R5cGVfaW1hZ2UnO1xyXG5leHBvcnQgY29uc3QgcG9wdXBOZXdBdmF0YXJTZWxlY3RvciA9ICcucG9wdXBfdHlwZV9hdmF0YXInO1xyXG5leHBvcnQgY29uc3QgcG9wdXBDb25maXJtU2VsZWN0b3IgPSAnLnBvcHVwX3R5cGVfY29uZmlybSc7XHJcblxyXG5leHBvcnQgY29uc3QgdXNlck5hbWUgPSAnLnByb2ZpbGVfX25hbWUnO1xyXG5leHBvcnQgY29uc3QgdXNlckpvYiA9ICcucHJvZmlsZV9fb2NjdXBhdGlvbic7XHJcbmV4cG9ydCBjb25zdCB1c2VyQXZhdGFyID0gJy5wcm9maWxlX19hdmF0YXInXHJcblxyXG5leHBvcnQgY29uc3QgZWxlbWVudHNDb250YWluZXIgPSAnLmVsZW1lbnRzJztcclxuZXhwb3J0IGNvbnN0IGVsZW1lbnRzVGVtcGxhdGUgPSAnLmVsZW1lbnRzX190ZW1wbGF0ZSc7XHJcbmV4cG9ydCBjb25zdCBlbGVtZW50U2VsZWN0b3IgPSAnLmVsZW1lbnQnO1xyXG5leHBvcnQgY29uc3QgZWxlbWVudEltYWdlU2VsZWN0b3IgPSAnLmVsZW1lbnRfX2ltYWdlJztcclxuZXhwb3J0IGNvbnN0IGVsZW1lbnRDYXB0aW9uU2VsZWN0b3IgPSAnLmVsZW1lbnRfX3RleHQnXHJcbmV4cG9ydCBjb25zdCBlbGVtZW50TGlrZUNvdW50ZXIgPSAnLmVsZW1lbnRfX2Zhdi1jb3VudGVyJ1xyXG5leHBvcnQgY29uc3QgcmVtb3ZlQnV0dG9uU2VsZWN0b3IgPSAnLmVsZW1lbnRfX2Jpbic7XHJcbmV4cG9ydCBjb25zdCBmYXZCdXR0b25TZWxlY3RvciA9ICcuZWxlbWVudF9fZmF2JztcclxuXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX3N1Ym1pdC1idXR0b25cIixcclxuICBhY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc3VibWl0LWJ1dHRvbl9hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yX3Zpc2libGVcIixcclxuICBpbnB1dEVycm9yQm9yZGVyOiBcImZvcm1fX2lucHV0X2Vycm9yXCIsXHJcbn1cclxuXHJcbi8vINCa0L3QvtC/0LrQsCDQuNC30LzQtdC90LXQvdC40Y8g0LDQstCw0YLQsNGA0LBcclxuZXhwb3J0IGNvbnN0IGVkdGlBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyLWNvbnRhaW5lcicpXHJcbi8vINCa0L3QvtC/0LrQsCDQuCDRhNC+0YDQvNCwINC/0L7Qv9Cw0L8g0L/RgNC+0YTQuNC70Y9cclxuZXhwb3J0IGNvbnN0IHBvcHVwV2l0aFVzZXJJbmZvT3BlbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgJy5wcm9maWxlX19idXR0b24tY2hhbmdlJ1xyXG4pO1xyXG5leHBvcnQgY29uc3QgaW5wdXRMaXN0U2VsZWN0b3IgPSAnLmZvcm1fX2lucHV0JztcclxuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19pbnB1dF90eXBlX25hbWUnKTtcclxuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2lucHV0X3R5cGVfb2NjdXBhdGlvbicpO1xyXG4vLyDQmtC90L7Qv9C60LAg0Lgg0LjQvdC/0YPRgtGLINC/0L7Qv9Cw0L8g0L3QvtCy0L7QtSDQvNC10YHRgtC+XHJcbmV4cG9ydCBjb25zdCBwb3B1cFdpdGhQbGFjZUluZm9PcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAnLnByb2ZpbGVfX2J1dHRvbi1hZGQnXHJcbik7XHJcbmV4cG9ydCBjb25zdCBlbGVtZW50SW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBlbGVtZW50SW1hZ2VDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAnLnBvcHVwX19pbWFnZS1jYXB0aW9uJ1xyXG4pO1xyXG5leHBvcnQgY29uc3QgZm9ybVNlbGVjdG9yID0gJy5mb3JtJztcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3Byb2ZpbGUtZm9ybSddO1xyXG5leHBvcnQgY29uc3QgcGxhY2VGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3BsYWNlLWZvcm0nXTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1snYXZhdGFyLWZvcm0nXVxyXG4iLCJpbXBvcnQge1xyXG4gIGVsZW1lbnRDYXB0aW9uU2VsZWN0b3IsXHJcbiAgZWxlbWVudEltYWdlU2VsZWN0b3IsXHJcbiAgZWxlbWVudFNlbGVjdG9yLFxyXG4gIGVsZW1lbnRMaWtlQ291bnRlcixcclxuICBmYXZCdXR0b25TZWxlY3RvcixcclxuICByZW1vdmVCdXR0b25TZWxlY3RvcixcclxufSBmcm9tICcuLi91dGlscy9jb25zdGFudHMuanMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGdldEN1cnJlbnRVc2VyLFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcclxuICAgIG9wZW5JbWFnZVBvcHVwLFxyXG4gICAgb3BlbkNvbmZpcm1Qb3B1cCxcclxuICAgIGxpa2VIYW5kbGVyXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIHRoaXMuX2xpa2VIYW5kbGVyID0gbGlrZUhhbmRsZXI7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2dldEN1cnJlbnRVc2VyID0gZ2V0Q3VycmVudFVzZXI7XHJcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcclxuICAgIHRoaXMuX29wZW5JbWFnZVBvcHVwID0gb3BlbkltYWdlUG9wdXA7XHJcbiAgICB0aGlzLl9vcGVuQ29uZmlybVBvcHVwID0gb3BlbkNvbmZpcm1Qb3B1cDtcclxuICAgIHRoaXMuZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnRJbWFnZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudExpa2VDb3VudGVyKTtcclxuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbiA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnRDYXB0aW9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcmVtb3ZlSWNvbiA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fYmluJyk7XHJcbiAgICB0aGlzLl9mYXZCdXR0b24gPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihmYXZCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihlbGVtZW50U2VsZWN0b3IpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLmVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IocmVtb3ZlQnV0dG9uU2VsZWN0b3IpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+XHJcbiAgICAgICAgdGhpcy5fb3BlbkNvbmZpcm1Qb3B1cCh0aGlzLl9jYXJkSWQsIHRoaXMuZWxlbWVudClcclxuICAgICAgKTtcclxuICAgIHRoaXMuZWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihmYXZCdXR0b25TZWxlY3RvcilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT5cclxuICAgICAgICB0aGlzLl9saWtlSGFuZGxlcihldnQsIHRoaXMuX2NhcmRJZCwgdGhpcy5fbGlrZUNvdW50ZXIpXHJcbiAgICAgICk7XHJcbiAgICB0aGlzLmVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoZWxlbWVudEltYWdlU2VsZWN0b3IpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcclxuICAgICAgICB0aGlzLl9vcGVuSW1hZ2VQb3B1cCh7IG5hbWU6IGV2dC50YXJnZXQuYWx0LCBsaW5rOiBldnQudGFyZ2V0LnNyYyB9KTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9nZXRDdXJyZW50VXNlci50aGVuKCh1c2VyKSA9PiB7XHJcbiAgICAgIGlmICh1c2VyLl9pZCA9PT0gdGhpcy5fb3duZXJJZCkge1xyXG4gICAgICAgIHRoaXMuX3JlbW92ZUljb24uY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5fbGlrZXMuZmluZCgoZWwpID0+IGVsLl9pZCA9PT0gdXNlci5faWQpKSB7XHJcbiAgICAgICAgdGhpcy5fZmF2QnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2VsZW1lbnRfX2Zhdl9hY3RpdmUnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgdGhpcy5faXRlbXMudGhlbihpdGVtcyA9PiB7XHJcbiAgICBpdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKVxyXG4gICAgfSk7XHJcbiAgIH0pXHJcbiAgICBcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCl7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICAgIHRoaXMudXNlciA9IHt9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8odXNlcikge1xyXG4gICAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gdXNlci5uYW1lO1xyXG4gICAgICB0aGlzLl9hYm91dC50ZXh0Q29udGVudCA9IHVzZXIuYWJvdXQ7XHJcbiAgICAgIHRoaXMuX2F2YXRhci5zcmMgPSB1c2VyLmF2YXRhcjtcclxuICAgICAgdGhpcy5faWQgPSB1c2VyLl9pZDtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKHVzZXIpIHtcclxuICAgIHRoaXMudXNlci5uYW1lID0gdXNlci5uYW1lO1xyXG4gICAgdGhpcy51c2VyLmFib3V0ID0gdXNlci5hYm91dDtcclxuICAgIHRoaXMudXNlci5hdmF0YXIgPSB1c2VyLmF2YXRhcjtcclxuICAgIHRoaXMudXNlci5pZCA9IHVzZXIuX2lkO1xyXG4gICAgcmV0dXJuIHRoaXMudXNlcjtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VyQXZhdGFyKHthdmF0YXJ9KSB7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgUG9wdXB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcil7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSlcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIilcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgb3Blbigpe1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKVxyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKVxyXG4gIH1cclxuXHJcbiAgY2xvc2UoKXtcclxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSlcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIilcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCl7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpPT57XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfb3BlbmVkJykgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWljb24nKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKClcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpXHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgZWxlbWVudEltYWdlLCBlbGVtZW50SW1hZ2VDYXB0aW9uIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKXtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7bmFtZSwgbGlua30pe1xyXG4gICAgc3VwZXIub3BlbigpXHJcbiAgICBlbGVtZW50SW1hZ2Uuc3JjID0gbGluaztcclxuICAgIGVsZW1lbnRJbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgZWxlbWVudEltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgZm9ybVNlbGVjdG9yLCBpbnB1dExpc3RTZWxlY3RvciwgY29uZmlnIH0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcclxuaW1wb3J0IHsgUG9wdXAgfSBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdEZvcm0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybSA9IGhhbmRsZVN1Ym1pdEZvcm07XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihmb3JtU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRMaXN0U2VsZWN0b3IpKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpXHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnJlZHVjZSgoYWNjLCBjdXIpID0+IHtcclxuICAgICAgYWNjW2N1ci5uYW1lXSA9IGN1ci52YWx1ZTtcclxuICAgICAgcmV0dXJuIGFjYztcclxuICAgIH0sIHt9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKXtcclxuICAgIGlmKGlzTG9hZGluZyl7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLidcclxuICAgIH1lbHNlIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0odGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKXtcclxuICAgIHN1cGVyLm9wZW4oKVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gJy4vUG9wdXAnO1xyXG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICcuLi91dGlscy9jb25zdGFudHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCh0aGlzLl9jYXJkSWQsIHRoaXMuX2VsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBvcGVuKGNhcmRJZCwgZWxlbWVudCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZElkO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpXHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdGlvbiB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFtcclxuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9vcHRpb25zLmlucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9vcHRpb25zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gIH1cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiBldnQucHJldmVudERlZmF1bHQoKSk7XHJcblxyXG4gICAgLy/QodCx0YDQvtGBINGB0L7RgdGC0L7Rj9C90LjRjyDQutC90L7Qv9C60LgsINC/0L7RgdC70LUg0YHQsNCx0LzQuNGC0LBcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2V0JywgKCkgPT4ge1xyXG4gICAgICBzZXRUaW1lb3V0KFxyXG4gICAgICAgICgpID0+IHRoaXMuc2V0QnV0dG9uU3RhdGUoKSxcclxuICAgICAgICAwXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL9Cf0YDQvtCy0LXRgNC60LAg0LLRgdC10YUg0LjQvdC/0YPRgtC+0LIg0Lgg0YPRgdGC0LDQvdC+0LLQutCwINGB0L7RgdGC0L7Rj9C90LjRjyDQutC90L7Qv9C60LhcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX29wdGlvbnMuaW5wdXRTZWxlY3RvcilcclxuICAgICAgLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT5cclxuICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl90b2dnbGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgICB0aGlzLnNldEJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuICB9XHJcblxyXG4gIHNldEJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2dldElucHV0U3RhdHVzKHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9vcHRpb25zLmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fb3B0aW9ucy5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvL9C/0YDQvtCy0LXRgNC60LAg0LLRgdC10YUg0LjQvdC/0YPRgtC+0LIg0YTQvtGA0LzRi1xyXG4gIF9nZXRJbnB1dFN0YXR1cyhpbnB1dExpc3QpIHtcclxuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICAvL9Cj0YHRgtCw0L3QvtCy0LrQsFxc0YPQtNCw0LvQtdC90LjQtSDQv9C+0LvRjyDRgSDQvtGI0LjQsdC60L7QuVxyXG4gIF90b2dnbGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxyXG4gICAgICA/IHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudClcclxuICAgICAgOiB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgLy/QktGL0LHQvtGAINC90YPQttC90L7Qs9C+IHNwYW4g0YEg0L7RiNC40LHQutC+0LlcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQubmFtZX0taW5wdXQtZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX29wdGlvbnMuZXJyb3JDbGFzcyk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9vcHRpb25zLmlucHV0RXJyb3JCb3JkZXIpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5uYW1lfS1pbnB1dC1lcnJvcmBcclxuICAgICk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9vcHRpb25zLmVycm9yQ2xhc3MpO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fb3B0aW9ucy5pbnB1dEVycm9yQm9yZGVyKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBBcGkgfSBmcm9tICcuLi9jb21wb25lbnRzL0FwaS5qcyc7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xyXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSAnLi4vY29tcG9uZW50cy9TZWNpdG9uLmpzJztcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzJztcclxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyc7XHJcbmltcG9ydCB7IFBvcHVwV2l0aENvbmZpcm1hdGlvbiB9IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzJztcclxuaW1wb3J0IHsgRm9ybVZhbGlkYXRpb24gfSBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0aW9uLmpzJztcclxuaW1wb3J0IHtcclxuICBlbGVtZW50c0NvbnRhaW5lcixcclxuICBlbGVtZW50c1RlbXBsYXRlLFxyXG4gIGpvYklucHV0LFxyXG4gIG5hbWVJbnB1dCxcclxuICBwbGFjZUZvcm0sXHJcbiAgYXZhdGFyRm9ybSxcclxuICBwb3B1cEltYWdlU2VsZWN0b3IsXHJcbiAgcG9wdXBQbGFjZVNlbGVjdG9yLFxyXG4gIHBvcHVwUHJvZmlsZVNlbGVjdG9yLFxyXG4gIHBvcHVwTmV3QXZhdGFyU2VsZWN0b3IsXHJcbiAgcG9wdXBXaXRoUGxhY2VJbmZvT3BlbkJ1dHRvbixcclxuICBwb3B1cFdpdGhVc2VySW5mb09wZW5CdXR0b24sXHJcbiAgcHJvZmlsZUZvcm0sXHJcbiAgdXNlckpvYixcclxuICB1c2VyTmFtZSxcclxuICB1c2VyQXZhdGFyLFxyXG4gIHBvcHVwQ29uZmlybVNlbGVjdG9yLFxyXG4gIGVkdGlBdmF0YXJCdXR0b24sXHJcbn0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcclxuaW1wb3J0IHtjb25maWd9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcydcclxuaW1wb3J0ICcuLi8uLi9wYWdlcy9pbmRleC5jc3MnO1xyXG5cclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0aW9uKGNvbmZpZywgcHJvZmlsZUZvcm0pO1xyXG5jb25zdCBwbGFjZUZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0aW9uKGNvbmZpZywgcGxhY2VGb3JtKTtcclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRpb24oY29uZmlnLCBhdmF0YXJGb3JtKTtcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lU2VsZWN0b3I6IHVzZXJOYW1lLFxyXG4gIGpvYlNlbGVjdG9yOiB1c2VySm9iLFxyXG4gIGF2YXRhclNlbGVjdG9yOiB1c2VyQXZhdGFyLFxyXG59KTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoXHJcbiAgJ2h0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS8nLFxyXG4gICdiZmVhMmZiMy0xZDQ5LTRlMGEtYmJjNC0zMzNhYTJlZmIwODgnXHJcbik7XHJcblxyXG4vLyDQl9Cw0L/QvtC70L3QtdC90LjQtSDQv9GA0L7RhNC40LvRj1xyXG5hcGkuZ2V0VXNlcigpLnRoZW4oKHVzZXIpID0+IHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXIpKTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQocGxhY2UpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBwbGFjZSxcclxuICAgIGFwaS5nZXRVc2VyKCksXHJcbiAgICBlbGVtZW50c1RlbXBsYXRlLFxyXG4gICAgKHsgbmFtZSwgbGluayB9KSA9PiBwb3B1cFdpdGhJbWFnZS5vcGVuKHsgbmFtZSwgbGluayB9KSxcclxuICAgIC8vINCf0LXRgNC10LTQsNGH0LAg0LTQsNC90L3Ri9GFINC+INC60LDRgNGC0L7Rh9C60LUg0Lgg0Y3Qu9C10LzQtdC90YLQtSDQutCw0YDRgtC+0YfQutC4INCyINC/0L7Qv9Cw0L9cclxuICAgIChjYXJkSWQsIGVsZW1lbnQpID0+IHtcclxuICAgICAgcG9wdXBXaXRoQ29uZmlybS5vcGVuKGNhcmRJZCwgZWxlbWVudCk7XHJcbiAgICB9LFxyXG4gICAgKGV2dCwgY2FyZElkLCBsaWtlQ291bnRlcikgPT4ge1xyXG4gICAgICBpZiAoIWV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlbGVtZW50X19mYXZfYWN0aXZlJykpIHtcclxuICAgICAgICBhcGkuYWRkTGlrZShjYXJkSWQpLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgICAgICBsaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aDtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGkucmVtb3ZlTGlrZShjYXJkSWQpLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgICAgICBsaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aDtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50X19mYXZfYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgKS5nZW5lcmF0ZUNhcmQoKTtcclxuICByZXR1cm4gY2FyZDtcclxufVxyXG5cclxuY29uc3QgcGxhY2VMaXN0ID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgaXRlbXM6IGFwaS5nZXRDYXJkcygpLFxyXG4gICAgcmVuZGVyZXI6IChwbGFjZSkgPT4ge1xyXG4gICAgICBwbGFjZUxpc3QuYWRkSXRlbShjcmVhdGVDYXJkKHBsYWNlKSk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgZWxlbWVudHNDb250YWluZXJcclxuKTtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHBvcHVwSW1hZ2VTZWxlY3Rvcik7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhVc2VySW5mbyA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHBvcHVwUHJvZmlsZVNlbGVjdG9yLFxyXG4gICh7IG5hbWUsIGFib3V0IH0pID0+IHtcclxuICAgIHBvcHVwV2l0aFVzZXJJbmZvLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICBhcGlcclxuICAgICAgLmVkaXRVc2VyKHsgbmFtZSwgYWJvdXQgfSlcclxuICAgICAgLnRoZW4oKHVzZXIpID0+IHtcclxuICAgICAgICB1c2VySW5mby5lZGl0VXNlckluZm8odXNlcik7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBwb3B1cFdpdGhVc2VySW5mby5jbG9zZSgpO1xyXG4gICAgICAgIHBvcHVwV2l0aFVzZXJJbmZvLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbik7XHJcblxyXG5jb25zdCBwb3B1cFdpdGhQbGFjZUluZm8gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBwb3B1cFBsYWNlU2VsZWN0b3IsXHJcbiAgKHsgcGxhY2VOYW1lLCBwbGFjZUltYWdlIH0pID0+IHtcclxuICAgIC8vINCh0L7RhdGA0LDQvdC10L3QuNC1Li4uLlxyXG4gICAgcG9wdXBXaXRoUGxhY2VJbmZvLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcblxyXG4gICAgYXBpLmFkZENhcmQoe1xyXG4gICAgICAgIG5hbWU6IHBsYWNlTmFtZSxcclxuICAgICAgICBsaW5rOiBwbGFjZUltYWdlLFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigocGxhY2UpID0+IHtcclxuICAgICAgICBwbGFjZUxpc3QuYWRkSXRlbShjcmVhdGVDYXJkKHBsYWNlKSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBwb3B1cFdpdGhQbGFjZUluZm8ucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgICAgcG9wdXBXaXRoUGxhY2VJbmZvLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuKTtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aE5ld0F2YXRhciA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHBvcHVwTmV3QXZhdGFyU2VsZWN0b3IsXHJcbiAgKGF2YXRhck9iaikgPT4ge1xyXG4gICAgYXBpLmVkaXRVc2VyQXZhdGFyKGF2YXRhck9iaikudGhlbigoKSA9PiB7XHJcbiAgICAgIHBvcHVwV2l0aE5ld0F2YXRhci5yZW5kZXJMb2FkaW5nKHRydWUpXHJcbiAgICAgIHVzZXJJbmZvLmVkaXRVc2VyQXZhdGFyKGF2YXRhck9iaik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCk9PiB7XHJcbiAgICAgIHBvcHVwV2l0aE5ld0F2YXRhci5yZW5kZXJMb2FkaW5nKGZhbHNlKVxyXG4gICAgICBwb3B1cFdpdGhOZXdBdmF0YXIuY2xvc2UoKVxyXG4gICAgfSk7XHJcbiAgfVxyXG4pO1xyXG5cclxuY29uc3QgcG9wdXBXaXRoQ29uZmlybSA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXHJcbiAgcG9wdXBDb25maXJtU2VsZWN0b3IsXHJcbiAgKGNhcmRJZCwgZWxlbWVudCkgPT4ge1xyXG4gICAgYXBpLnJlbW92ZUNhcmQoY2FyZElkKS50aGVuKCgpID0+IHtcclxuICAgICAgZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgZWxlbWVudCA9IG51bGw7XHJcbiAgICAgIHBvcHVwV2l0aENvbmZpcm0uY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuKTtcclxuXHJcbnBsYWNlTGlzdC5yZW5kZXJJdGVtcygpO1xyXG5cclxucG9wdXBXaXRoVXNlckluZm9PcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsICgpID0+IHtcclxuICBhcGkuZ2V0VXNlcigpLnRoZW4oKHVzZXIpID0+IHtcclxuICAgIGNvbnN0IHsgbmFtZSwgYWJvdXQgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKHVzZXIpO1xyXG4gICAgbmFtZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICAgIGpvYklucHV0LnZhbHVlID0gYWJvdXQ7XHJcbiAgICBwcm9maWxlRm9ybVZhbGlkYXRpb24uc2V0QnV0dG9uU3RhdGUoKTtcclxuICAgIHBvcHVwV2l0aFVzZXJJbmZvLm9wZW4oKTtcclxuICB9KTtcclxufSk7XHJcblxyXG5wb3B1cFdpdGhQbGFjZUluZm9PcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT5cclxuICBwb3B1cFdpdGhQbGFjZUluZm8ub3BlbigpXHJcbik7XHJcblxyXG5lZHRpQXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsICgpID0+IHBvcHVwV2l0aE5ld0F2YXRhci5vcGVuKCkpO1xyXG5cclxucG9wdXBXaXRoVXNlckluZm8uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucG9wdXBXaXRoUGxhY2VJbmZvLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnBvcHVwV2l0aE5ld0F2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy/QktCw0LvQuNC00LDRhtC40Y8g0YTQvtGA0LxcclxucHJvZmlsZUZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxucGxhY2VGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuIl0sIm5hbWVzIjpbIkFwaSIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfYmFzZVVybCIsIl90b2tlbiIsImtleSIsInZhbHVlIiwiZmV0Y2giLCJjb25jYXQiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiX3JlZiIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXZhdGFyT2JqIiwiX3JlZjIiLCJsaW5rIiwiY2FyZElkIiwiZWxlbWVudHNUZW1wbGF0ZSIsImVsZW1lbnRJbWFnZVNlbGVjdG9yIiwiZmF2QnV0dG9uU2VsZWN0b3IiLCJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJhY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQm9yZGVyIiwiZWR0aUF2YXRhckJ1dHRvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInBvcHVwV2l0aFVzZXJJbmZvT3BlbkJ1dHRvbiIsIm5hbWVJbnB1dCIsImpvYklucHV0IiwicG9wdXBXaXRoUGxhY2VJbmZvT3BlbkJ1dHRvbiIsImVsZW1lbnRJbWFnZSIsImVsZW1lbnRJbWFnZUNhcHRpb24iLCJwcm9maWxlRm9ybSIsImZvcm1zIiwicGxhY2VGb3JtIiwiYXZhdGFyRm9ybSIsIkNhcmQiLCJkYXRhIiwiZ2V0Q3VycmVudFVzZXIiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwib3BlbkltYWdlUG9wdXAiLCJvcGVuQ29uZmlybVBvcHVwIiwibGlrZUhhbmRsZXIiLCJfbmFtZSIsIl9saW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfbGlrZUhhbmRsZXIiLCJfY2FyZElkIiwiX2lkIiwiX293bmVySWQiLCJvd25lciIsIl9nZXRDdXJyZW50VXNlciIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX29wZW5JbWFnZVBvcHVwIiwiX29wZW5Db25maXJtUG9wdXAiLCJlbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX2ltYWdlIiwiX2xpa2VDb3VudGVyIiwiX2ltYWdlQ2FwdGlvbiIsIl9yZW1vdmVJY29uIiwiX2ZhdkJ1dHRvbiIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfdGhpcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJ0YXJnZXQiLCJhbHQiLCJzcmMiLCJfdGhpczIiLCJ1c2VyIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiZmluZCIsImVsIiwidG9nZ2xlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImZvckVhY2giLCJpdGVtIiwicHJlcGVuZCIsIlVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9hYm91dCIsIl9hdmF0YXIiLCJhdmF0YXIiLCJpZCIsIl9yZWYzIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwid2luZG93IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVFc2NDbG9zZSIsIl9wb3B1cCIsImFkZCIsImNvbnRhaW5zIiwiY2xvc2UiLCJQb3B1cFdpdGhJbWFnZSIsIl9Qb3B1cCIsIl9pbmhlcml0cyIsIl9zdXBlciIsImNhbGwiLCJfZ2V0IiwiX2dldFByb3RvdHlwZU9mIiwicHJvdG90eXBlIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZVN1Ym1pdEZvcm0iLCJfaGFuZGxlU3VibWl0Rm9ybSIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwicmVkdWNlIiwiYWNjIiwiY3VyIiwiaXNMb2FkaW5nIiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsIlBvcHVwV2l0aENvbmZpcm1hdGlvbiIsImhhbmRsZVN1Ym1pdCIsIl9idXR0b24iLCJfaGFuZGxlU3VibWl0IiwiX2VsZW1lbnQiLCJGb3JtVmFsaWRhdGlvbiIsIm9wdGlvbnMiLCJmb3JtRWxlbWVudCIsIl9vcHRpb25zIiwiX2Zvcm1FbGVtZW50IiwiX2J1dHRvbkVsZW1lbnQiLCJzZXRUaW1lb3V0Iiwic2V0QnV0dG9uU3RhdGUiLCJpbnB1dEVsZW1lbnQiLCJfdG9nZ2xlSW5wdXRFcnJvciIsIl9nZXRJbnB1dFN0YXR1cyIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImlucHV0TGlzdCIsInNvbWUiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInByb2ZpbGVGb3JtVmFsaWRhdGlvbiIsInBsYWNlRm9ybVZhbGlkYXRpb24iLCJhdmF0YXJGb3JtVmFsaWRhdGlvbiIsInVzZXJJbmZvIiwiYXBpIiwiY3JlYXRlQ2FyZCIsInBsYWNlIiwiZ2V0VXNlciIsInBvcHVwV2l0aEltYWdlIiwib3BlbiIsInBvcHVwV2l0aENvbmZpcm0iLCJsaWtlQ291bnRlciIsInJlbW92ZUxpa2UiLCJ1cGRhdGVkQ2FyZCIsImFkZExpa2UiLCJnZW5lcmF0ZUNhcmQiLCJzZXRVc2VySW5mbyIsInBsYWNlTGlzdCIsImdldENhcmRzIiwiYWRkSXRlbSIsInBvcHVwV2l0aFVzZXJJbmZvIiwicmVuZGVyTG9hZGluZyIsImVkaXRVc2VyIiwiZWRpdFVzZXJJbmZvIiwiZmluYWxseSIsInBvcHVwV2l0aFBsYWNlSW5mbyIsInBsYWNlTmFtZSIsInBsYWNlSW1hZ2UiLCJhZGRDYXJkIiwicG9wdXBXaXRoTmV3QXZhdGFyIiwiZWRpdFVzZXJBdmF0YXIiLCJyZW1vdmVDYXJkIiwicmVuZGVySXRlbXMiLCJfdXNlckluZm8kZ2V0VXNlckluZm8iLCJnZXRVc2VySW5mbyIsInNldEV2ZW50TGlzdGVuZXJzIiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=